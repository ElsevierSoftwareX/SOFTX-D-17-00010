(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    129132,       3261]
NotebookOptionsPosition[    128404,       3235]
NotebookOutlinePosition[    128751,       3250]
CellTagsIndexPosition[    128708,       3247]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{
  3.6892137059716*^9, {3.6893511988022785`*^9, 3.6893511991202936`*^9}, {
   3.6893512983639297`*^9, 3.6893513564292564`*^9}, {3.6893515036047335`*^9, 
   3.6893515037556934`*^9}, {3.689352294622032*^9, 3.6893522951063576`*^9}, {
   3.68935249162702*^9, 3.68935249366016*^9}, {3.6893526701980047`*^9, 
   3.689352672454137*^9}, {3.6893527075191426`*^9, 3.689352707720156*^9}, {
   3.689352763837416*^9, 3.6893527641804*^9}, {3.689352801962598*^9, 
   3.689352802585677*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"solveTruss2D", " ", "v1", ".0", " ", "by", " ", 
    RowBox[{"Dr", ".", " ", "Hakan"}], " ", "Ozbasaran"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Parameters", " ", "of", " ", "the", " ", "block", " ", "are"}], 
    ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["e",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{
     RowBox[{"Young", "'"}], "s", " ", "modulus"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["\[Nu]",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{
     RowBox[{"Poisson", "'"}], "s", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["fa",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "stress"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["da",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "displacement"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["\[Lambda]a",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "buckling", " ", "eigenvalue"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["joint",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Coordinates", " ", "of", " ", "joints", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"joint", " ", "id"}], ",", " ", "x", ",", " ", "z"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Joint"}], " ", "id", " ",
      "must", " ", "be", " ", "given", " ", "starting", " ", "from", " ", "1",
      " ", "and", " ", "without", " ", "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["section",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Section", " ", "properties", " ", "as", " ", 
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"section", " ", "id"}], ",", " ", "a", ",", " ", "Ix", ",",
            " ", "Iy", ",", " ", "It", ",", " ", "Iw", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x0", ",", " ", "y0"}], "}"}]}], "}"}],
         FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Where"}]}]}], ";", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
      RowBox[{"Section", " ", "area"}]}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Ix",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Moment", " ", "of", " ", "inertia", " ", "about", " ", "strong", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Iy",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Moment", " ", "of", " ", "inertia", " ", "about", " ", "weak", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["It",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{"Torsional", " ", "constant"}]}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{
     StyleBox["Iw",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{"Warping", " ", "constant"}]}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{
     StyleBox["x0",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Distance", " ", "between", " ", "centroid", " ", "and", " ", "shear", 
      " ", "center", " ", "on", " ", "x", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["y0",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Distance", " ", "between", " ", "centroid", " ", "and", " ", "shear", 
      " ", "center", " ", "on", " ", "y", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Section", " ", "id", " ", "must", " ", "be", " ", "given", " ", 
     "starting", " ", "from", " ", "1", " ", "and", " ", "without", " ", 
     "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["bars",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Bars", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"bar", " ", "id"}], ",", " ", 
         RowBox[{"section", " ", "id"}], ",", " ", 
         RowBox[{"start", " ", "joint", " ", "id"}], ",", " ", 
         RowBox[{"end", " ", "joint", " ", "id"}]}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Bar"}], " ", "id", " ", 
     "must", " ", "be", " ", "given", " ", "starting", " ", "from", " ", "1", 
     " ", "and", " ", "without", " ", "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     StyleBox["support",
      FontColor->RGBColor[1, 0, 0]], " ", ":", 
     RowBox[{"Supports", " ", "as", " ", 
      RowBox[{
       StyleBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jnt", " ", "id"}], ",", " ", "x", ",", " ", "z"}], "}"}],
        FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Options"}], " ", "for", 
      " ", "x", " ", "and", " ", "z", " ", "are", " ", 
      StyleBox["0",
       FontColor->RGBColor[1, 0, 1]]}], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[":",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["free",
      FontColor->RGBColor[1, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    RowBox[{
     StyleBox["1",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[":",
      FontColor->RGBColor[1, 0, 1]], 
     RowBox[{
      StyleBox["fixed",
       FontColor->RGBColor[1, 0, 1]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["force",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Forces", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"jnt", " ", "id"}], ",", " ", "Px", ",", " ", "Pz"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["mass",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Masses", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"jnt", " ", "id"}], ",", " ", "Mx", ",", " ", "Mz"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["mode",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Modal", " ", "analysis", " ", "parameters", " ", 
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{"rm", ",", " ", "Ta", ",", " ", "Tb"}], "}"}],
         FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Where"}]}]}], ";", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{
      StyleBox["rm",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
      RowBox[{
      "Requested", " ", "number", " ", "of", " ", "free", " ", "vibration", 
       " ", "modes", " ", 
       RowBox[{"(", 
        StyleBox[
         RowBox[{
          RowBox[{"0", " ", ":", "false"}], ",", " ", 
          RowBox[{
           RowBox[{"\[GreaterEqual]", "0"}], " ", ":", 
           RowBox[{
           "number", " ", "of", " ", "the", " ", "modes", " ", 
            "requested"}]}]}],
         FontColor->RGBColor[1, 0, 1]], ")"}]}]}]}], ",", " ", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Ta",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Lower", " ", "limit", " ", "of", " ", "the", " ", "unallowed", " ", 
      "region"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Tb",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Upper", " ", "limit", " ", "of", " ", "the", " ", "unallowed", " ", 
      RowBox[{"region", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "It", " ", "is", " ", "not", " ", "compulsory", " ", "to", " ", "arrange", 
    " ", "the", " ", "lists", " ", "by", " ", "their", " ", 
    RowBox[{"id", "."}]}], " ", "*)"}]}]], "Input",
 Editable->False,
 CellChangeTimes->CompressedData["
1:eJwdzFtIk3EABXDNhfZQboJ5Ya6WDhyyYUtzQo2UDBslqUUl2mWjspV8zuji
WivWGjVboeZlMocGlS+SmK1mBlYa4SzLcujYlgxn6UbmhZnzwf7nezj84HA4
XBlVdGZdWFhYOgnUOnmCarU/Z9/f5Eyon1EWwDb52gX46pJDCR2eARWs3D6v
offHqx9C2a/lJvim64EJihlHBuieGWeH97cGvkBW6sQ43LT6yA3juS4v/FR3
bhaeTJkLQKHpQBB638YlqIimLYYUOFXlyoXJtVn5cLStXworfIwTMMryTA7z
eqgqWFlj1ENpV4cBGqhOI8yaZz2GGcsRL+Hw4qANNkRoe6GI1TF5nbjDfHsF
ehIUkWpiYlR9NCya3rAZxv/+wYbmcC0fakU3MyE7kF0KkwMU7dl7mlNwz0JA
DlN1q+WwTNd4HqqZUiWcmUpSwRhz6x1Yk7heD78uVXS2Ej/8kVqh7Cq/D4bY
HAe0+MuckGkS/IRBc1oIcjliWk6zVGQhljdHZsC7vEIrHLsYbYPeMSe/m1gg
dNF23HJnw97vebsgq66R2UOsfaJgQWpkNhZWHF3hwBhGEg9K0o/RLqTVvncR
m9a6P0I3NWiHu9uXRuE18ZDdTbTuLBmGMsGVkUn8KD7TbvMN1f8jHp7Ob4GS
53OH9t/w57RYwwvht3GpIEgM+YqF8LSm+EXJU38Ob28frVd+8DVcvJxrg5KA
px+GdLHvoKqBiiwlaiaMG+F/MVSW6Q==
  "]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "=", "200000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fa", "=", "355"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"da", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"joint", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1500", ",", "500"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1500", ",", "2000"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "2000", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"section", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "624", ",", 
         RowBox[{"39.62", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"17.11", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.3305", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"1.071", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "19.39"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "784", ",", 
         RowBox[{"36.91", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"36.91", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.106", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.244", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "764.34", ",", 
         RowBox[{"80.14", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"8.489", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.6924", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"118.74", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[1, 1, 0.85]], 
   RowBox[{
    RowBox[{"bars", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "3", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "3", ",", "2", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"support", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "1", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"force", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "25000"}], ",", 
        RowBox[{"-", "40000"}]}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mass", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"25000", "/", "9810"}], ",", 
        RowBox[{"40000", "/", "9810"}]}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mode", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.1", ",", "0.4"}], "}"}]}], ";"}]}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.687273051353778*^9, 3.6872730578061476`*^9}, {
   3.6873238146766567`*^9, 3.6873238190514774`*^9}, {3.6892137008312054`*^9, 
   3.6892137869561605`*^9}, {3.6892138381420326`*^9, 3.689213862548967*^9}, 
   3.689213897862929*^9, {3.689213933101201*^9, 3.6892140601735363`*^9}, {
   3.6892140905751176`*^9, 3.6892141434969964`*^9}, {3.6892141811400633`*^9, 
   3.689214181655671*^9}, {3.68921422329947*^9, 3.689214242003583*^9}, 
   3.6892149863596897`*^9, {3.6892154462050185`*^9, 3.689215451829873*^9}, {
   3.6892155378298087`*^9, 3.689215544327174*^9}, 3.6892176466604147`*^9, {
   3.689255190077363*^9, 3.689255203625141*^9}, {3.6892552468996525`*^9, 
   3.689255258546285*^9}, {3.6892592743800344`*^9, 3.6892592931350784`*^9}, {
   3.689342532265752*^9, 3.6893425381279364`*^9}, {3.689342911975874*^9, 
   3.689342919460107*^9}, 3.6893437162980676`*^9, {3.6893437816782207`*^9, 
   3.6893438251589823`*^9}, 3.6893438819407034`*^9, 3.6893448609092846`*^9, 
   3.6893448937704563`*^9, {3.689345058376234*^9, 3.689345058657482*^9}, {
   3.68934519695084*^9, 3.6893452003327117`*^9}, {3.6893483545831585`*^9, 
   3.6893483972596083`*^9}, {3.6894001335590525`*^9, 3.689400162447435*^9}, {
   3.689404097948248*^9, 3.689404101747957*^9}, {3.6894053106335382`*^9, 
   3.689405324457299*^9}, {3.689405638347908*^9, 3.6894056416722813`*^9}, {
   3.689405984517335*^9, 3.689406004381376*^9}, {3.689406045630512*^9, 
   3.6894060762150807`*^9}, {3.6894062297264743`*^9, 
   3.6894062337853565`*^9}, {3.689406270839508*^9, 3.689406297554367*^9}, {
   3.6894063378048134`*^9, 3.6894063665591173`*^9}, {3.6894064071987867`*^9, 
   3.6894064397377872`*^9}, {3.6894064710629053`*^9, 3.689406472261752*^9}, {
   3.689406552465357*^9, 3.6894066096427565`*^9}, 3.6894067292161846`*^9, {
   3.6894068319947557`*^9, 3.6894068825564566`*^9}, 3.689407055406478*^9, 
   3.6895636697717733`*^9, {3.689918850390972*^9, 3.6899188507072196`*^9}, {
   3.6899192960160537`*^9, 3.6899192984267583`*^9}, {3.694501388965107*^9, 
   3.6945013976013217`*^9}, {3.69450142952781*^9, 3.6945014299587207`*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveTruss2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "e_", ",", "\[Nu]_", ",", "fa_", ",", "da_", ",", "\[Lambda]a_"}], 
      "}"}], ",", "joint_", ",", "section_", ",", "bars_", ",", "support_", 
     ",", "force_", ",", "mass_", ",", "mode_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sTime", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
       RowBox[{"jnt", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"joint", ",", "First"}], "]"}]}], ",", 
       RowBox[{"sec", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"section", ",", "First"}], "]"}]}], ",", 
       RowBox[{"bar", "=", "bars"}], ",", "k", ",", "j1", ",", "j2", ",", 
       "lx", ",", "lz", ",", "a", ",", "l", ",", "c", ",", "s", ",", "kn", 
       ",", "place", ",", "n1", ",", "n2", ",", "n", ",", "del", ",", "p", 
       ",", "d", ",", "dC", ",", "f", ",", "tensB", ",", "compB", ",", "sC", 
       ",", "fbC", ",", "tbC", ",", "ftbC", ",", "lC", ",", "pfm", ",", 
       "bfailS", ",", "bfailFB", ",", "bfailTB", ",", "bfailFTB", ",", "v", 
       ",", "failB", ",", "excB", ",", "dwg", ",", "Pa", ",", "Px", ",", "Py",
        ",", "Pf", ",", "r2", ",", "Pt", ",", "Pft", ",", "Pcr", ",", "Pl", 
       ",", "failJ", ",", "excJ", ",", "period", ",", "excM", ",", "m", ",", 
       "res"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assembling", " ", "global", " ", "rigidity", " ", "matrix", " ", 
       RowBox[{"(", 
        StyleBox["k",
         FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"Length", "[", "jnt", "]"}]}], ",", 
           RowBox[{"2", "*", 
            RowBox[{"Length", "[", "jnt", "]"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Start", " ", 
         RowBox[{"(", 
          StyleBox["j1",
           FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", "end", 
         " ", 
         RowBox[{"(", 
          StyleBox["j2",
           FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "joints", " ", "of",
          " ", "the", " ", "bar"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"j1", "=", 
          RowBox[{"jnt", "[", 
           RowBox[{"[", 
            RowBox[{"bar", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"j2", "=", 
          RowBox[{"jnt", "[", 
           RowBox[{"[", 
            RowBox[{"bar", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "4"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Lengths", " ", "of", " ", "the", " ", "bar", " ", "in", " ", "x", 
           " ", 
           RowBox[{"(", 
            StyleBox["lx",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", "z", 
           " ", 
           RowBox[{"(", 
            StyleBox["lz",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "directions"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lx", "=", 
          RowBox[{
           RowBox[{"j2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"j1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lz", "=", 
          RowBox[{
           RowBox[{"j2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"j1", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Area", " ", 
           RowBox[{"(", 
            StyleBox["a",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
           "length", " ", 
           RowBox[{"(", 
            StyleBox["l",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "of", " ", "the", 
           " ", 
           RowBox[{"bar", ".", " ", 
            StyleBox["c",
             FontColor->RGBColor[0.5, 0, 0.5]]}], 
           StyleBox[" ",
            FontColor->RGBColor[0.5, 0, 0.5]], "and", " ", 
           StyleBox["s",
            FontColor->RGBColor[0.5, 0, 0.5]], 
           StyleBox[" ",
            FontColor->RGBColor[0.5, 0, 0.5]], "coefficients"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"sec", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["lx", "2"], "+", 
            SuperscriptBox["lz", "2"]}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"lx", "/", "l"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"lz", "/", "l"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Rigidity", " ", "matrix", " ", "of", " ", "the", " ", "bar", " ", 
           RowBox[{"(", 
            StyleBox["kn",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"kn", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"e", "*", "a"}], "l"], "*", 
            RowBox[{"(", GridBox[{
               {
                SuperscriptBox["c", "2"], 
                RowBox[{"c", "*", "s"}], 
                RowBox[{"-", 
                 SuperscriptBox["c", "2"]}], 
                RowBox[{
                 RowBox[{"-", "c"}], "*", "s"}]},
               {
                RowBox[{"c", "*", "s"}], 
                SuperscriptBox["s", "2"], 
                RowBox[{
                 RowBox[{"-", "c"}], "*", "s"}], 
                RowBox[{"-", 
                 SuperscriptBox["s", "2"]}]},
               {
                RowBox[{"-", 
                 SuperscriptBox["c", "2"]}], 
                RowBox[{
                 RowBox[{"-", "c"}], "*", "s"}], 
                SuperscriptBox["c", "2"], 
                RowBox[{"c", "*", "s"}]},
               {
                RowBox[{
                 RowBox[{"-", "c"}], "*", "s"}], 
                RowBox[{"-", 
                 SuperscriptBox["s", "2"]}], 
                RowBox[{"c", "*", "s"}], 
                SuperscriptBox["s", "2"]}
              }], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Appending", " ", 
           StyleBox[
            RowBox[{"{", 
             RowBox[{"l", ",", " ", "c", ",", " ", "s"}], "}"}],
            FontColor->RGBColor[0.5, 0, 0.5]], " ", "list", " ", "at", " ", 
           "the", " ", "end", " ", "of", " ", "each", " ", "bar", " ", "for", 
           " ", "further", " ", "use"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"bar", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "c", ",", "s"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "A", " ", "switch", " ", "to", " ", "find", " ", "the", " ", 
           "place", " ", "of", " ", "the", " ", "terms", " ", "in", " ", 
           "the", " ", "global", " ", "rigidity", " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["place",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"place", "[", "n1_", "]"}], ":=", 
          RowBox[{"Switch", "[", 
           RowBox[{"n1", ",", "\[IndentingNewLine]", "1", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"j1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", "2", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"2", "*", 
              RowBox[{"j1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "3", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"j2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", "4", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"2", "*", 
              RowBox[{"j2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Adding", " ", "the", " ", "rigidity", " ", "matrix", " ", "of", 
           " ", "the", " ", "bar", " ", "to", " ", "the", " ", "global", " ", 
           "rigidity", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"k", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", "n1", "]"}], ",", 
                RowBox[{"place", "[", "n2", "]"}]}], "]"}], "]"}], "+=", 
             RowBox[{"kn", "[", 
              RowBox[{"[", 
               RowBox[{"n1", ",", "n2"}], "]"}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n2", ",", "4"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "bar", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Constructing", " ", "unnecessary", " ", "row", " ", "and", " ", 
        "column", " ", "list", " ", 
        RowBox[{"(", 
         StyleBox["del",
          FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "due", " ", "to", 
        " ", "support", " ", "conditions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"del", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"support", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "*", 
                RowBox[{"support", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], 
              "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"support", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del", ",", 
             RowBox[{"{", 
              RowBox[{"2", "*", 
               RowBox[{"support", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "support", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"del", "=", 
       RowBox[{"Sort", "[", "del", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
        "columns", " ", "from", " ", "the", " ", "global", " ", "rigidity", 
        " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{"k", ",", "del"}], "]"}], "]"}], ",", "del"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "There", " ", "is", " ", "a", " ", "big", " ", "IF", " ", "here"}], 
        ",", " ", 
        RowBox[{
        "if", " ", "the", " ", "system", " ", "is", " ", "kinematically", " ",
          "stable"}], ",", "\[IndentingNewLine]", 
        RowBox[{"then", " ", "continue"}], ",", " ", "else", ",", " ", 
        RowBox[{
        "return", " ", "\"\<0\>\"", " ", "as", " ", "the", " ", "result"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PositiveDefiniteMatrixQ", "[", "k", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Constructing", " ", "load", " ", "matrix", " ", 
          RowBox[{"(", 
           StyleBox["p",
            FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"2", "*", 
             RowBox[{"Length", "[", "jnt", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"force", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], "]"}],
               "]"}], "=", 
             RowBox[{"force", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"2", "*", 
                RowBox[{"force", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
             RowBox[{"force", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "3"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "force", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
           "columns", " ", "from", " ", "the", " ", "force", " ", "matrix"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"N", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{"p", ",", "del"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Calculating", " ", "node", " ", "displacement", " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["d",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
           "adding", " ", "deleted", " ", "nodes"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"k", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"d", ",", "0", ",", 
              RowBox[{"del", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "del", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "calculating", " ", "joint", " ", "displacement", " ", "capacity", 
           " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["dC",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dC", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"d", "/", "da"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "loop", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["f",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{"Bar", " ", "forces"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["tensB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "tension", " ", "bars"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["compB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "compression", " ", "bars"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"demand", "/", "capacity"}], " ", "ratios"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["sC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", "Stress"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["fbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Flexural", " ", "buckling"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["tbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Torsional", " ", "buckling"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["ftbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Flexural", "-", 
             RowBox[{"torsional", " ", "buckling"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["lC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", "Limiting"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["pfm",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Possible", " ", "failure", " ", "mode", " ", "of", " ", "the", 
             " ", "bars"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailS",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "stress", " ", "failure"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailFB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "flexural", " ", "buckling", " ", "failure"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailTB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "torsional", " ", "buckling", " ", "failure"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailFTB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
             RowBox[{
             "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
              "flexural"}], "-", 
             RowBox[{"torsional", " ", "buckling", " ", "failure"}]}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["v",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Total", " ", "volume", " ", "of", " ", "material", " ", 
             "used"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["failB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "failed", " ", "bars"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Total", " ", "of", " ", "exceeding", " ", "capacity", " ", "of", 
             " ", "bars"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["dwg",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Truss", " ", "drawing"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"f", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "bar", " ", "forces", " ", 
           "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"tensB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "tension", " ", "bar", " ", "count"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"compB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "compression", " ", "bar", " ", 
           "count"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"sC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "stress", " ", "capacity", 
           " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"fbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "flexural", " ", 
           "buckling", " ", "capacity", " ", "matrix"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"tbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "torsional", " ", 
           "buckling", " ", "capacity", " ", "matrix"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ftbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Template", " ", "for", " ", "the", " ", "flexural"}], "-", 
           RowBox[{
           "torsional", " ", "buckling", " ", "capacity", " ", "matrix"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "limiting", " ", 
           "capacity", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"pfm", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "possible", " ", "failure",
            " ", "mode", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"bfailS", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "stress", " ", "failure"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"bfailFB", " ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "flexural", " ", "buckling", " ", "failure"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bfailTB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "torsional", " ", "buckling", " ", "failure"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bfailFTB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", 
            " ", "to", " ", "flexural"}], "-", 
           RowBox[{"torsional", " ", "buckling", " ", "failure"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"v", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "total", " ", "volume", " ", "of", 
           " ", "the", " ", "bars"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"failB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Container", " ", "for", " ", "failed", " ", "bars"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"excB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "exceeding", " ", "capacity"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dwg", "=", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "truss", " ", "drawing", 
           " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Start", " ", 
            RowBox[{"(", 
             StyleBox["j1",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
            "end", " ", 
            RowBox[{"(", 
             StyleBox["j2",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "joints", " ", 
            "of", " ", "the", " ", "bar"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"j1", "=", 
             RowBox[{"jnt", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"j2", "=", 
             RowBox[{"jnt", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "4"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Area", " ", 
              RowBox[{"(", 
               StyleBox["a",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
              "length", " ", 
              RowBox[{"(", 
               StyleBox["l",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "of", " ", 
              "the", " ", 
              RowBox[{"bar", ".", " ", 
               StyleBox["c",
                FontColor->RGBColor[0.5, 0, 0.5]]}], 
              StyleBox[" ",
               FontColor->RGBColor[0.5, 0, 0.5]], "and", " ", 
              StyleBox["s",
               FontColor->RGBColor[0.5, 0, 0.5]], 
              StyleBox[" ",
               FontColor->RGBColor[0.5, 0, 0.5]], "coefficients"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"a", "=", 
             RowBox[{"sec", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"bar", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"l", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"c", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"s", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Assembling", " ", "internal", " ", "force", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "the", " ", "bar", " ", 
              "forces", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["f",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{
              FractionBox[
               RowBox[{"e", "*", "a"}], "l"], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], 
                    "]"}], "-", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], 
                    "]"}]}], ")"}]}], "+", 
                RowBox[{"s", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "*", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "-", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "*", 
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], 
                  ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Update", " ", "tension", " ", 
               RowBox[{"(", 
                StyleBox["tensB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "-", " ", 
              RowBox[{"compression", " ", 
               RowBox[{"(", 
                StyleBox["compB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "bar", " ", 
               "count"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ">", 
               "0"}], ",", 
              RowBox[{"tensB", "++"}], ",", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<", 
               "0"}], ",", 
              RowBox[{"compB", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Allowed", " ", "compressive", " ", "load", " ", "of", " ", 
              "the", " ", "bar", " ", 
              RowBox[{"(", 
               StyleBox["Pa",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Pa", "=", 
             RowBox[{"fa", "*", "a"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Assembling", " ", "stress", " ", "capacity", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["sC",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sC", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"Abs", "[", 
              FractionBox[
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "Pa"],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "If", " ", "the", " ", "member", " ", "is", " ", "under", " ", 
              "compression", " ", "calculate", " ", "the", " ", "global", " ",
               "buckling", " ", "capacities"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<", 
               "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                "the", " ", "bar", " ", "about", " ", "x", " ", "axis", " ", 
                RowBox[{"(", 
                 StyleBox["Px",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Px", "=", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}], 
                 SuperscriptBox["l", "2"]]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", "about", " ", "y", " ", "axis", " ", 
                 RowBox[{"(", 
                  StyleBox["Py",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Py", "=", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "4"}], "]"}], 
                   "]"}]}], 
                 SuperscriptBox["l", "2"]]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["Pf",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pf", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"Px", ",", "Py"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Assembling", " ", "flexural", " ", "buckling", " ", 
                 "capacity", " ", "of", " ", "the", " ", "bar", " ", "to", 
                 " ", "the", " ", "list", " ", 
                 RowBox[{"(", 
                  StyleBox["fbC",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"fbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pf"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 SubsuperscriptBox["r", "2", "2"], " ", "value", " ", "of", 
                 " ", "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["r2",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"r2", "=", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "+", 
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "4"}], "]"}], 
                    "]"}]}], "a"], "+", 
                 SuperscriptBox[
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Torsional", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["Pt",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pt", "=", 
                FractionBox[
                 RowBox[{
                  FractionBox[
                   RowBox[{"e", "*", 
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                    "]"}]}], 
                   RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}]}]], "+", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "6"}], "]"}], 
                    "]"}]}], 
                   SuperscriptBox["l", "2"]]}], "r2"]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Assembling", " ", "torsional", " ", "buckling", " ", 
                 "capacity", " ", "of", " ", "the", " ", "bar", " ", "to", 
                 " ", "the", " ", "list", " ", 
                 RowBox[{"(", 
                  StyleBox["tbC",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pt"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Flexural", "-", 
                 RowBox[{
                 "torsional", " ", "buckling", " ", "load", " ", "of", " ", 
                  "the", " ", "bar", " ", 
                  RowBox[{"(", 
                   StyleBox["Pft",
                    FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "by", " ", 
                  "using", " ", 
                  StyleBox["Pcr",
                   FontColor->RGBColor[0.5, 0, 0.5]], " ", "variable"}]}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "\[NotEqual]", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pft", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"Pcr", "/.", 
                    RowBox[{"NSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Px", "-", "Pcr"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Py"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Pt"}], ")"}], "*", "r2"}], "+", 
                    RowBox[{
                    SuperscriptBox["Pcr", "2"], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Py"}], ")"}], "*", 
                    SuperscriptBox[
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "2"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Px"}], ")"}], "*", 
                    SuperscriptBox[
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "2"]}]}], ")"}]}]}], "\[Equal]", 
                    "0"}], ",", "Pcr"}], "]"}]}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pft", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"Pf", ",", "Pt"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Assembling", " ", "flexural"}], "-", 
                 RowBox[{
                 "torsional", " ", "buckling", " ", "capacity", " ", "of", 
                  " ", "the", " ", "bar", " ", "to", " ", "the", " ", "list", 
                  " ", 
                  RowBox[{"(", 
                   StyleBox["ftbC",
                    FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ftbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pft"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Limiting", " ", "load", " ", "of", " ", "the", " ", "bar", 
                 " ", 
                 RowBox[{"(", 
                  StyleBox["Pl",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pl", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"Pa", ",", "Pf", ",", "Pt", ",", "Pft"}], "]"}]}], 
               ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "...", "Else", " ", "buckling", " ", "capacities", " ", "are",
                  " ", "Zero", " ", "which", " ", "are", " ", "preset", " ", 
                 "before", " ", "the", " ", "loop"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "limiting", " ", "load", " ", "is", " ", "equal", " ", "to", 
                 " ", "the", " ", "compressive", " ", "force", " ", 
                 "limit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Pl", "=", "Pa"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "assembling", " ", "limiting", " ", "capacity", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "the", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["lC",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"lC", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"Abs", "[", 
              FractionBox[
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "Pl"],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "assembling", " ", "possible", " ", "failure", " ", "mode", " ", 
              "of", " ", "the", " ", "bar", " ", "to", " ", "the", " ", 
              "list", " ", 
              RowBox[{"(", 
               StyleBox["pfm",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "counting", " ", "the", " ", "bars", " ", "which", " ", "are", 
               " ", "prone", " ", "to", " ", "stress", " ", 
               RowBox[{"(", 
                StyleBox["bfailS",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], ",", " ", 
              RowBox[{"flexural", " ", "buckling", " ", 
               RowBox[{"(", 
                StyleBox["bfailFB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"torsional", " ", "buckling", " ", 
                RowBox[{"(", 
                 StyleBox["bfailTB",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
                "flexural"}], "-", 
               RowBox[{"torsional", " ", "buckling", " ", 
                RowBox[{"(", 
                 StyleBox["bfailFTB",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", 
                "failure"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
               "\[Equal]", "0"}], ",", 
              RowBox[{
               RowBox[{"pfm", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
               "\"\<N\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Which", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Pl", "\[Equal]", "Pa"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<S\>\""}], ";", 
                  RowBox[{"bfailS", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Pl", "\[Equal]", "Pf"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<FB\>\""}], ";", 
                  RowBox[{"bfailFB", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Pl", "\[Equal]", "Pt"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<TB\>\""}], ";", 
                  RowBox[{"bfailTB", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pl", "\[Equal]", "Pft"}], "&&", 
                  RowBox[{"Pf", ">", "Pft"}], "&&", 
                  RowBox[{"Pt", ">", "Pft"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<FTB\>\""}], ";", 
                  RowBox[{"bfailFTB", "++"}]}]}], "\[IndentingNewLine]", 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "adding", " ", "the", " ", "volume", " ", "of", " ", "the", " ", 
              "bar", " ", "to", " ", "the", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["v",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"v", "+=", 
             RowBox[{"a", "*", "l"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "If", " ", "limiting", " ", "capacity", " ", "exceeds", " ", 
               "1"}], ",", " ", 
              RowBox[{
              "update", " ", "failed", " ", "bars", " ", "counter", " ", 
               RowBox[{"(", 
                StyleBox["failB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
               "exceeding", " ", "container", " ", 
               RowBox[{"(", 
                StyleBox["excB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"lC", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ">", 
               "1"}], ",", 
              RowBox[{
               RowBox[{"failB", "++"}], ";", 
               RowBox[{"excB", "+=", 
                RowBox[{
                 RowBox[{"lC", "[", 
                  RowBox[{"[", 
                   RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "bar", " ", "lines", " ", "to", " ", "drawing", 
              " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{"j1", ",", "1"}], "]"}], ",", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"j2", ",", "1"}], "]"}]}], "}"}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "bar", " ", "labels", " ", "to", " ", "the", " ", 
              "drawing", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "Blue", ",", 
                  RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "2"], ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "2"]}], "}"}]}], 
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "bar", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "loop", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["failJ",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{
             "Number", " ", "of", " ", "excessively", " ", "displaced", " ", 
              "joints"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excJ",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Exceeding", " ", "amount", " ", "of", " ", "joint", " ", 
             "displacement"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["dwg",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Adds", " ", "joint", " ", "labels", " ", "to", " ", "the", " ", 
             "truss", " ", "drawing"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"failJ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "excessively", " ", "deflected", " ", 
           "joints"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"excJ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Exceeding", " ", "amount", " ", "of", " ", "joint", " ", 
           "deflection"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "If", " ", "limiting", " ", "displacement", " ", "is", " ", 
             "exceeded"}], ",", " ", 
            RowBox[{"update", " ", "failed", " ", "bars", " ", "counter", " ", 
             RowBox[{"(", 
              StyleBox["failJ",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
             "exceeding", " ", "container", " ", 
             RowBox[{"(", 
              StyleBox["excJ",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dC", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ">", "1"}], ",", 
              RowBox[{
               RowBox[{"failJ", "++"}], ";", 
               RowBox[{"excJ", "+=", 
                RowBox[{
                 RowBox[{"dC", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "-", "1"}]}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adds", " ", "joint", " ", "labels", " ", "to", " ", "the", " ", 
              "truss", " ", "drawing", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"jnt", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "Red", ",", 
                  RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"jnt", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "1"}], "]"}]}], 
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "jnt", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "section", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["period",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{
             "Periods", " ", "of", " ", "requested", " ", "free", " ", 
              "vibration", " ", "modes"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excM",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Exceeding", " ", "amount", " ", "of", " ", "free", " ", 
             "vibration", " ", "period", " ", 
             RowBox[{"capacities", "."}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"period", "=", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"empty", " ", "period", " ", "list"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"excM", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "exceeding", " ", "free", " ", 
           "vibration", " ", "capacities"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mode", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Constructing", " ", "mass", " ", "matrix", " ", 
             RowBox[{"(", 
              StyleBox["m",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{"Length", "[", "jnt", "]"}]}], ",", 
                 RowBox[{"2", "*", 
                  RowBox[{"Length", "[", "jnt", "]"}]}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], ",", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}]}], 
                  "]"}], "]"}], "=", 
                RowBox[{"mass", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"2", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                "=", 
                RowBox[{"mass", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "3"}], "]"}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "mass", "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
              "columns", " ", "from", " ", "the", " ", "mass", " ", "matrix", 
              " ", 
              RowBox[{"(", 
               StyleBox["m",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"m", "=", 
             RowBox[{"N", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"m", ",", "del"}], "]"}], "]"}], ",", "del"}], 
                "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "periods", " ", "of", " ", "the", " ", 
              "requested", " ", "modes", " ", "to", " ", "the", " ", "list", 
              " ", 
              RowBox[{"(", 
               StyleBox["period",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"period", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "*", "\[Pi]"}], ")"}], "/", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                SqrtBox[
                 RowBox[{"Eigenvalues", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"k", ",", "m"}], "}"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]], ",", 
                RowBox[{"\[Infinity]", "|", 
                 RowBox[{"-", "\[Infinity]"}]}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "exceeding", " ", "vibration", " ", "capacities", 
              " ", "to", " ", "the", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["excM",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mode", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "<", 
                  RowBox[{"period", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "<", 
                  RowBox[{"mode", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"excM", "+=", 
                   RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"period", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"period", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], 
                    RowBox[{
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "period", "]"}]}], "}"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Arranging", " ", "the", " ", "results", " ", 
           RowBox[{"(", 
            StyleBox["res",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteTime", "[", "]"}], "-", "sTime"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              FractionBox["tensB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["compB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"tensB", "+", "compB"}], 
                RowBox[{"Length", "[", "bar", "]"}]]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["failB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["failJ", 
               RowBox[{"Length", "[", "joint", "]"}]], ",", "excB", ",", 
              "excJ", ",", "excM", ",", 
              RowBox[{"excB", "+", "excJ", "+", "excM"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"d", ",", "f", ",", "period"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "dC", ",", "sC", ",", "fbC", ",", "tbC", ",", "ftbC", ",", 
              "lC"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"pfm", ",", 
              FractionBox["bfailS", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailFB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailTB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailFTB", 
               RowBox[{"Length", "[", "bar", "]"}]]}], "}"}], ",", 
            "\[IndentingNewLine]", "dwg"}], "\[IndentingNewLine]", "}"}]}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ELSE", " ", "section", " ", "of", " ", "the", " ", "big", " ", 
           RowBox[{"IF", ".", " ", "If"}], " ", "the", " ", "rigidity", " ", 
           "matrix", " ", "is", " ", "not", " ", "positive", " ", 
           "definite"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "then", " ", "the", " ", "structure", " ", "is", " ", 
           "kinematically", " ", 
           RowBox[{"unstable", ".", " ", "The"}], " ", "software", " ", 
           "returns", " ", "0."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "res"}]}], "]"}]}], ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.689349890960096*^9, 3.689350028069974*^9}, {
   3.689350063987007*^9, 3.689350082420111*^9}, {3.689350127219674*^9, 
   3.6893501566753473`*^9}, {3.689350189965223*^9, 3.6893502318736677`*^9}, {
   3.689350271306884*^9, 3.6893502994345446`*^9}, {3.6893504030554266`*^9, 
   3.689350457189575*^9}, {3.6893504876902876`*^9, 3.689350538615232*^9}, {
   3.68935056879596*^9, 3.6893505800836086`*^9}, 3.689350652088685*^9, {
   3.689351932404416*^9, 3.689351959729148*^9}, {3.689352319542137*^9, 
   3.6893523232958326`*^9}, 3.689404699520012*^9, {3.689405278019506*^9, 
   3.689405282007326*^9}, 3.689406992274901*^9, {3.689407109902956*^9, 
   3.6894071325899754`*^9}, {3.689563678990287*^9, 3.6895636856039734`*^9}, 
   3.689918910289324*^9, {3.6899189671805625`*^9, 3.6899189689948316`*^9}, {
   3.6899190285489388`*^9, 3.6899190833877125`*^9}, 3.6899209563845396`*^9, {
   3.6912217186674366`*^9, 3.6912217215774975`*^9}, {3.6944200897069483`*^9, 
   3.6944201023935213`*^9}, {3.6945013190282297`*^9, 3.694501322613019*^9}, {
   3.699681169992593*^9, 3.6996811706620502`*^9}, {3.7022089470038304`*^9, 
   3.7022089488005476`*^9}, {3.7110928184350433`*^9, 
   3.7110928348882313`*^9}, {3.7110929025758343`*^9, 
   3.7110929238415422`*^9}, {3.711092962794668*^9, 3.711092966325959*^9}, {
   3.711093220717083*^9, 3.711093224638994*^9}, {3.7110963878918624`*^9, 
   3.7110964085330544`*^9}, {3.7110965623468637`*^9, 3.71109659457271*^9}, 
   3.711096763191366*^9, 3.7110969301459246`*^9, {3.7110978588271103`*^9, 
   3.7110978870747232`*^9}, {3.711098446087738*^9, 3.711098452349049*^9}, 
   3.7110984864010134`*^9, 3.711098696463073*^9, {3.711098793027605*^9, 
   3.7110987999850035`*^9}, {3.7111012812185774`*^9, 
   3.7111013094843016`*^9}, {3.711101523672221*^9, 3.7111015275159335`*^9}, {
   3.71110177423512*^9, 3.711101778344552*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Output", " ", "of", " ", "the", " ", "script", " ", "is", " ", "a", " ", 
    "nested", " ", "list", " ", "as", " ", "follows"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      StyleBox["Time",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"execution", " ", "time"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["v",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Material", " ", "volume"}]}], ",", " ", 
       RowBox[{
        StyleBox["tensB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Tension", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["compB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Compression", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["zeroB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Constructive", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["failB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Failed", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["failJ",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Failed", " ", "joints", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["excB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excJ",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excM",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Mode", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excT",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"total", " ", "penalty"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["d",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", "displacements"}]}], ",", " ", 
       RowBox[{
        StyleBox["f",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", "forces"}]}], ",", " ", 
       RowBox[{
        StyleBox["period",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Requested", " ", "free", " ", "vibration", " ", "periods"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["dC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", 
         RowBox[{"disp", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["sC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", 
         RowBox[{"str", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["fbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Flex", " ", 
         RowBox[{"buck", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["tbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Tors", ".", " ", "buck", ".", " ", "c", "."}]}], ",", " ", 
       RowBox[{
        StyleBox["ftbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Flex", ".", 
         RowBox[{"-", 
          RowBox[{"tors", ".", " ", "buck", ".", " ", "c", "."}]}]}]}], ",", 
       " ", 
       RowBox[{
        StyleBox["lC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Limiting", " ", 
         RowBox[{"c", "."}]}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["pfm",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Possible", " ", "failure", " ", "mode", " ", "of", " ", "the", " ", 
         "bars"}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailS",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Bar", " ", "count", " ", "prone", " ", "to", " ", "stress", " ", 
         "failure", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailFB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"flex", ".", " ", "buck", ".", " ", "failure"}], 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailTB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"tors", ".", " ", "buck", ".", " ", "failure"}], 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailFTB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"flex", ".", " ", 
          RowBox[{"-", " ", 
           RowBox[{"tors", ".", " ", "buck", ".", " ", "failure"}]}]}], 
         RowBox[{"(", "%", ")"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["dwg",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Truss", " ", "drawing"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.711098880334609*^9, 3.711098883889809*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solveTruss2D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"e", ",", "\[Nu]", ",", "fa", ",", "da", ",", "\[Lambda]a"}], 
    "}"}], ",", "joint", ",", "section", ",", "bars", ",", "support", ",", 
   "force", ",", "mass", ",", "mode"}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.689350667194549*^9, 3.689350677065151*^9}, {
   3.6893511313091726`*^9, 3.6893511352564015`*^9}, {3.6893514154767275`*^9, 
   3.6893514192649364`*^9}, {3.6893520101510153`*^9, 3.689352025921939*^9}, 
   3.6894069941612597`*^9, {3.689563716743971*^9, 3.6895637248196754`*^9}, {
   3.6899189455342455`*^9, 3.6899189460355997`*^9}, {3.702208967265808*^9, 
   3.7022089723947134`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0156625`5.6464060774981775", ",", 
   RowBox[{"{", 
    RowBox[{"6.060724927460976`*^6", ",", 
     FractionBox["1", "5"], ",", 
     FractionBox["4", "5"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "0.049584297590886436`"}], ",", 
       RowBox[{"-", "0.12232107616898971`"}], ",", 
       RowBox[{"-", "1.0544860644475802`"}], ",", 
       RowBox[{"-", "0.22260690910140693`"}], ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "40473.99612420771`"}], ",", 
       RowBox[{"-", "8287.707096834401`"}], ",", 
       RowBox[{"-", "10483.212402535346`"}], ",", "2950.503973872612`", ",", 
       RowBox[{"-", "11119.125867677489`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.032821474498266105`", ",", "0.0676862771990002`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0.002479214879544322`", ",", 
       "0.006116053808449486`", ",", "0.05272430322237901`", ",", 
       "0.011130345455070348`", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.18271034725626448`", ",", "0.030543545796242147`", ",", 
       "0.037666040537997075`", ",", "0.010873798047519638`", ",", 
       "0.04097846680456521`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.7489905745982096`", ",", "0.12364829378199203`", ",", 
       "0.03237450352543434`", ",", "0", ",", "0.03317831882380784`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
      "0.20431945785767025`", ",", "0.015342410062431493`", ",", 
       "0.12074000865941369`", ",", "0", ",", "0.012875380637275212`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.8215292614723014`", ",", "0.12364829378199203`", ",", 
       "0.12074000865941369`", ",", "0", ",", "0.03317831882380784`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
      "0.8215292614723014`", ",", "0.12364829378199203`", ",", 
       "0.12074000865941369`", ",", "0.010873798047519638`", ",", 
       "0.04097846680456521`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"FTB\"\>", ",", "\<\"FB\"\>", ",", "\<\"TB\"\>", 
       ",", "\<\"S\"\>", ",", "\<\"S\"\>"}], "}"}], ",", 
     FractionBox["2", "5"], ",", 
     FractionBox["1", "5"], ",", 
     FractionBox["1", "5"], ",", 
     FractionBox["1", "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1500", ",", "2000"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["1",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"750", ",", "1000"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1500", ",", "500"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["2",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"750", ",", "250"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1500", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1500", ",", "2000"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["3",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"1500", ",", "1250"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1500", ",", "2000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2000", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["4",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"1750", ",", "1000"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1500", ",", "500"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2000", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["5",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"1750", ",", "250"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["1",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["2",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"1500", ",", "500"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["3",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"1500", ",", "2000"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["4",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"2000", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.71110230354697*^9, 3.7111023188595347`*^9}, {
  3.7111034423798494`*^9, 3.7111034650205975`*^9}}]
}, Open  ]]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 690, 13, 50, "Input"],
Cell[1251, 35, 273, 9, 5, "Text"],
Cell[1527, 46, 9623, 257, 582, "Input"],
Cell[11153, 305, 273, 9, 5, "Text"],
Cell[11429, 316, 6026, 143, 302, "Input"],
Cell[17458, 461, 271, 9, 10, "Text"],
Cell[17732, 472, 96228, 2348, 6491, "Input"],
Cell[113963, 2822, 271, 9, 10, "Text"],
Cell[114237, 2833, 5585, 153, 278, "Input"],
Cell[119825, 2988, 273, 9, 5, "Text"],
Cell[CellGroupData[{
Cell[120123, 3001, 702, 13, 30, "Input"],
Cell[120828, 3016, 7560, 216, 180, "Output"]
}, Open  ]]
}
]
*)

