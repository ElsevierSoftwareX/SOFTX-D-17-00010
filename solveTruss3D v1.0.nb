(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    136440,       3427]
NotebookOptionsPosition[    135710,       3401]
NotebookOutlinePosition[    136057,       3416]
CellTagsIndexPosition[    136014,       3413]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 Editable->False,
 CellChangeTimes->{
  3.6892137059716*^9, {3.6893511988022785`*^9, 3.6893511991202936`*^9}, {
   3.6893512983639297`*^9, 3.6893513564292564`*^9}, {3.6893515036047335`*^9, 
   3.6893515037556934`*^9}, {3.689352294622032*^9, 3.6893522951063576`*^9}, {
   3.68935249162702*^9, 3.68935249366016*^9}, {3.6893526701980047`*^9, 
   3.689352672454137*^9}, {3.6893527075191426`*^9, 3.689352707720156*^9}, {
   3.689352763837416*^9, 3.6893527641804*^9}, {3.689352801962598*^9, 
   3.689352802585677*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"solveTruss3D", " ", "v1", ".0", " ", "by", " ", 
    RowBox[{"Dr", ".", " ", "Hakan"}], " ", "Ozbasaran"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Parameters", " ", "of", " ", "the", " ", "block", " ", "are"}], 
    ";"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["e",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{
     RowBox[{"Young", "'"}], "s", " ", "modulus"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["\[Nu]",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{
     RowBox[{"Poisson", "'"}], "s", " ", "ratio"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["fa",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "stress"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["da",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "displacement"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["\[Lambda]a",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Allowed", " ", "buckling", " ", "eigenvalue"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["joint",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Coordinates", " ", "of", " ", "joints", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"joint", " ", "id"}], ",", " ", "x", ",", " ", "y", ",", " ",
          "z"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Joint"}], " ", "id", " ",
      "must", " ", "be", " ", "given", " ", "starting", " ", "from", " ", "1",
      " ", "and", " ", "without", " ", "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["section",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Section", " ", "properties", " ", "as", " ", 
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"section", " ", "id"}], ",", " ", "a", ",", " ", "Ix", ",",
            " ", "Iy", ",", " ", "It", ",", " ", "Iw", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x0", ",", " ", "y0"}], "}"}]}], "}"}],
         FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Where"}]}]}], ";", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
      RowBox[{"Section", " ", "area"}]}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Ix",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Moment", " ", "of", " ", "inertia", " ", "about", " ", "strong", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Iy",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Moment", " ", "of", " ", "inertia", " ", "about", " ", "weak", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["It",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{"Torsional", " ", "constant"}]}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{
     StyleBox["Iw",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{"Warping", " ", "constant"}]}], ",", "\[IndentingNewLine]", 
    "   ", 
    RowBox[{
     StyleBox["x0",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Distance", " ", "between", " ", "centroid", " ", "and", " ", "shear", 
      " ", "center", " ", "on", " ", "x", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["y0",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Distance", " ", "between", " ", "centroid", " ", "and", " ", "shear", 
      " ", "center", " ", "on", " ", "y", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Section", " ", "id", " ", "must", " ", "be", " ", "given", " ", 
     "starting", " ", "from", " ", "1", " ", "and", " ", "without", " ", 
     "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["bars",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Bars", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"bar", " ", "id"}], ",", " ", 
         RowBox[{"section", " ", "id"}], ",", " ", 
         RowBox[{"start", " ", "joint", " ", "id"}], ",", " ", 
         RowBox[{"end", " ", "joint", " ", "id"}]}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Bar"}], " ", "id", " ", 
     "must", " ", "be", " ", "given", " ", "starting", " ", "from", " ", "1", 
     " ", "and", " ", "without", " ", "skipping", " ", "any", " ", 
     RowBox[{"number", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     StyleBox["support",
      FontColor->RGBColor[1, 0, 0]], " ", ":", 
     RowBox[{"Supports", " ", "as", " ", 
      RowBox[{
       StyleBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"jnt", " ", "id"}], ",", " ", "x", ",", " ", "y", ",", " ", 
          "z"}], "}"}],
        FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Options"}], " ", "for", 
      " ", "x"}]}], ",", " ", 
    RowBox[{
     RowBox[{"y", " ", "and", " ", "z", " ", "are", " ", 
      StyleBox["0",
       FontColor->RGBColor[1, 0, 1]]}], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[":",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["free",
      FontColor->RGBColor[1, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    RowBox[{
     StyleBox["1",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[":",
      FontColor->RGBColor[1, 0, 1]], 
     RowBox[{
      StyleBox["fixed",
       FontColor->RGBColor[1, 0, 1]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["force",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Forces", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"jnt", " ", "id"}], ",", " ", "Px", ",", " ", "Py", ",", " ",
          "Pz"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox["mass",
     FontColor->RGBColor[1, 0, 0]], " ", ":", 
    RowBox[{"Masses", " ", "as", " ", 
     RowBox[{
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"jnt", " ", "id"}], ",", " ", "Mx", ",", " ", "My", ",", " ",
          "Mz"}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      StyleBox["mode",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Modal", " ", "analysis", " ", "parameters", " ", 
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{"rm", ",", " ", "Ta", ",", " ", "Tb"}], "}"}],
         FontColor->RGBColor[0.5, 0, 0.5]], ".", " ", "Where"}]}]}], ";", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{
      StyleBox["rm",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
      RowBox[{
      "Requested", " ", "number", " ", "of", " ", "free", " ", "vibration", 
       " ", "modes", " ", 
       RowBox[{"(", 
        StyleBox[
         RowBox[{
          RowBox[{"0", " ", ":", "false"}], ",", " ", 
          RowBox[{
           RowBox[{"\[GreaterEqual]", "0"}], " ", ":", 
           RowBox[{
           "number", " ", "of", " ", "the", " ", "modes", " ", 
            "requested"}]}]}],
         FontColor->RGBColor[1, 0, 1]], ")"}]}]}]}], ",", " ", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Ta",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Lower", " ", "limit", " ", "of", " ", "the", " ", "unallowed", " ", 
      "region"}]}], ",", "\[IndentingNewLine]", "   ", 
    RowBox[{
     StyleBox["Tb",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
     RowBox[{
     "Upper", " ", "limit", " ", "of", " ", "the", " ", "unallowed", " ", 
      RowBox[{"region", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "It", " ", "is", " ", "not", " ", "compulsory", " ", "to", " ", "arrange", 
    " ", "the", " ", "lists", " ", "by", " ", "their", " ", 
    RowBox[{"id", "."}]}], " ", "*)"}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6891385371829233`*^9, 3.6891386011230803`*^9}, {
   3.6891388035597563`*^9, 3.6891390399809113`*^9}, {3.6891390867016253`*^9, 
   3.6891391581522017`*^9}, {3.689139191537285*^9, 3.6891393237921476`*^9}, {
   3.689139391746995*^9, 3.6891394044590735`*^9}, {3.689139746656765*^9, 
   3.68913980072075*^9}, {3.689139831378973*^9, 3.689139910786141*^9}, {
   3.6891399486556463`*^9, 3.68913999087904*^9}, {3.6891400512366676`*^9, 
   3.68914007147319*^9}, {3.6891401463936987`*^9, 3.689140424741929*^9}, {
   3.689140516316357*^9, 3.6891407588890247`*^9}, {3.689140801736467*^9, 
   3.6891408220196314`*^9}, {3.689140976153006*^9, 3.689141021238041*^9}, {
   3.6891411394907556`*^9, 3.689141300423271*^9}, {3.6891413332715197`*^9, 
   3.6891413574198656`*^9}, {3.689141520560695*^9, 3.689141672123926*^9}, {
   3.6891417101860104`*^9, 3.6891417160629373`*^9}, {3.689144069252099*^9, 
   3.6891442681128173`*^9}, {3.6891443793156576`*^9, 3.689144444594739*^9}, {
   3.6891444963093653`*^9, 3.6891445506533318`*^9}, {3.6891446520626965`*^9, 
   3.6891447479749155`*^9}, {3.689145057810072*^9, 3.6891450594975753`*^9}, {
   3.6891450919542723`*^9, 3.6891451194045715`*^9}, {3.6891451598598824`*^9, 
   3.6891451647036576`*^9}, {3.6891452263145123`*^9, 3.689145296934193*^9}, {
   3.6891453889253016`*^9, 3.68914539215949*^9}, {3.6892132914361343`*^9, 
   3.6892133623416457`*^9}, {3.689213409295823*^9, 3.689213616941037*^9}, {
   3.689213650935012*^9, 3.6892136894249344`*^9}, {3.6892139053629103`*^9, 
   3.689213905753678*^9}, {3.689214354331069*^9, 3.6892143682373543`*^9}, {
   3.6892154105358315`*^9, 3.689215432482035*^9}, {3.6892552468386087`*^9, 
   3.6892552468806524`*^9}, {3.689255374921955*^9, 3.6892553941820955`*^9}, {
   3.6892591407053304`*^9, 3.6892591473327107`*^9}, {3.6892591833378215`*^9, 
   3.689259255791922*^9}, {3.689259304906747*^9, 3.689259306755889*^9}, {
   3.6893424845366144`*^9, 3.6893425175937*^9}, {3.689342558169905*^9, 
   3.6893426156446824`*^9}, {3.689344606319393*^9, 3.6893446108191786`*^9}, {
   3.68935077969304*^9, 3.689350782419198*^9}, {3.689565071399558*^9, 
   3.6895650720390377`*^9}, 3.6899136766062717`*^9, {3.7110962009991703`*^9, 
   3.7110962795386195`*^9}, {3.711096336313879*^9, 3.7110963373950243`*^9}, 
   3.7110990148743124`*^9, {3.7111024611253996`*^9, 3.7111024626881013`*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e", "=", "200000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Nu]", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fa", "=", "355"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"da", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"joint", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1200", ",", "600", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "0", ",", "1200", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "800", ",", "600", ",", "1600"}], "}"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"section", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "624", ",", 
         RowBox[{"39.62", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"17.11", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.3305", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"1.071", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "19.39"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "784", ",", 
         RowBox[{"36.91", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"36.91", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.106", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.244", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "764.34", ",", 
         RowBox[{"80.14", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"8.489", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"0.6924", "*", 
          SuperscriptBox["10", "4"]}], ",", 
         RowBox[{"118.74", "*", 
          SuperscriptBox["10", "6"]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    Background->RGBColor[1, 1, 0.85]], 
   RowBox[{
    RowBox[{"bars", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "1", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "3", ",", "2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"support", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"force", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"-", "20000"}], ",", "25000", ",", 
        RowBox[{"-", "30000"}]}], "}"}], "}"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mass", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"20000", "/", "9810"}], ",", 
        RowBox[{"25000", "/", "9810"}], ",", 
        RowBox[{"30000", "/", "9810"}]}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mode", "=", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.1", ",", "0.4"}], "}"}]}], ";"}]}]}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.687273051353778*^9, 3.6872730578061476`*^9}, {
   3.6873238146766567`*^9, 3.6873238190514774`*^9}, {3.6892137008312054`*^9, 
   3.6892137869561605`*^9}, {3.6892138381420326`*^9, 3.689213862548967*^9}, 
   3.689213897862929*^9, {3.689213933101201*^9, 3.6892140601735363`*^9}, {
   3.6892140905751176`*^9, 3.6892141434969964`*^9}, {3.6892141811400633`*^9, 
   3.689214181655671*^9}, {3.68921422329947*^9, 3.689214242003583*^9}, 
   3.6892149863596897`*^9, {3.6892154462050185`*^9, 3.689215451829873*^9}, {
   3.6892155378298087`*^9, 3.689215544327174*^9}, 3.6892176466604147`*^9, {
   3.689255190077363*^9, 3.689255203625141*^9}, {3.6892552468996525`*^9, 
   3.689255258546285*^9}, {3.6892592743800344`*^9, 3.6892592931350784`*^9}, {
   3.689342532265752*^9, 3.6893425381279364`*^9}, {3.689342911975874*^9, 
   3.689342919460107*^9}, 3.6893437162980676`*^9, {3.6893437816782207`*^9, 
   3.6893438251589823`*^9}, 3.6893438819407034`*^9, 3.6893448609092846`*^9, 
   3.6893448937704563`*^9, {3.689345058376234*^9, 3.689345058657482*^9}, {
   3.68934519695084*^9, 3.6893452003327117`*^9}, {3.6893483545831585`*^9, 
   3.6893483972596083`*^9}, 3.689565085702688*^9, 3.689913734558251*^9, {
   3.6945015767521954`*^9, 3.694501580345945*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveTruss3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "e_", ",", "\[Nu]_", ",", "fa_", ",", "da_", ",", "\[Lambda]a_"}], 
      "}"}], ",", "joint_", ",", "section_", ",", "bars_", ",", "support_", 
     ",", "force_", ",", "mass_", ",", "mode_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sTime", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ",", 
       RowBox[{"jnt", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"joint", ",", "First"}], "]"}]}], ",", 
       RowBox[{"sec", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"section", ",", "First"}], "]"}]}], ",", 
       RowBox[{"bar", "=", "bars"}], ",", "k", ",", "j1", ",", "j2", ",", 
       "lx", ",", "ly", ",", "lz", ",", "a", ",", "l", ",", "cx", ",", "cy", 
       ",", "cz", ",", "kn", ",", "place", ",", "n1", ",", "n2", ",", "n", 
       ",", "del", ",", "p", ",", "d", ",", "dC", ",", "f", ",", "tensB", ",",
        "compB", ",", "sC", ",", "fbC", ",", "tbC", ",", "ftbC", ",", "lC", 
       ",", "pfm", ",", "bfailS", ",", "bfailFB", ",", "bfailTB", ",", 
       "bfailFTB", ",", "v", ",", "failB", ",", "excB", ",", "dwg", ",", "Pa",
        ",", "Px", ",", "Py", ",", "Pf", ",", "r2", ",", "Pt", ",", "Pft", 
       ",", "Pcr", ",", "Pl", ",", "failJ", ",", "excJ", ",", "period", ",", 
       "excM", ",", "m", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assembling", " ", "global", " ", "rigidity", " ", "matrix", " ", 
       RowBox[{"(", 
        StyleBox["k",
         FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "*", 
            RowBox[{"Length", "[", "jnt", "]"}]}], ",", 
           RowBox[{"3", "*", 
            RowBox[{"Length", "[", "jnt", "]"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Start", " ", 
         RowBox[{"(", 
          StyleBox["j1",
           FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", "end", 
         " ", 
         RowBox[{"(", 
          StyleBox["j2",
           FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "joints", " ", "of",
          " ", "the", " ", "bar"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"j1", "=", 
          RowBox[{"jnt", "[", 
           RowBox[{"[", 
            RowBox[{"bar", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"j2", "=", 
          RowBox[{"jnt", "[", 
           RowBox[{"[", 
            RowBox[{"bar", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "4"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Lengths", " ", "of", " ", "the", " ", "bar", " ", "in", " ", "x", 
            " ", 
            RowBox[{"(", 
             StyleBox["lx",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], ",", " ", 
           RowBox[{"y", " ", 
            RowBox[{"(", 
             StyleBox["ly",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", "z", 
            " ", 
            RowBox[{"(", 
             StyleBox["lz",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "directions"}]}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lx", "=", 
          RowBox[{
           RowBox[{"j2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"j1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ly", "=", 
          RowBox[{
           RowBox[{"j2", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", 
           RowBox[{"j1", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lz", "=", 
          RowBox[{
           RowBox[{"j2", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "-", 
           RowBox[{"j1", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Area", " ", 
            RowBox[{"(", 
             StyleBox["a",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
            "length", " ", 
            RowBox[{"(", 
             StyleBox["l",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "of", " ", "the",
             " ", 
            RowBox[{"bar", ".", " ", 
             StyleBox["cx",
              FontColor->RGBColor[0.5, 0, 0.5]]}]}], ",", " ", 
           StyleBox["cy",
            FontColor->RGBColor[0.5, 0, 0.5]], ",", " ", 
           RowBox[{
            StyleBox["cz",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", "coefficients"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"sec", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["lx", "2"], "+", 
            SuperscriptBox["ly", "2"], "+", 
            SuperscriptBox["lz", "2"]}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cx", "=", 
          RowBox[{"lx", "/", "l"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cy", "=", 
          RowBox[{"ly", "/", "l"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cz", "=", 
          RowBox[{"lz", "/", "l"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Rigidity", " ", "matrix", " ", "of", " ", "the", " ", "bar", " ", 
           RowBox[{"(", 
            StyleBox["kn",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"kn", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"e", "*", "a"}], "l"], "*", 
            RowBox[{"(", GridBox[{
               {
                SuperscriptBox["cx", "2"], 
                RowBox[{"cx", "*", "cy"}], 
                RowBox[{"cx", "*", "cz"}], 
                RowBox[{"-", 
                 SuperscriptBox["cx", "2"]}], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cy"}], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cz"}]},
               {
                RowBox[{"cx", "*", "cy"}], 
                SuperscriptBox["cy", "2"], 
                RowBox[{"cy", "*", "cz"}], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cy"}], 
                RowBox[{"-", 
                 SuperscriptBox["cy", "2"]}], 
                RowBox[{
                 RowBox[{"-", "cy"}], "*", "cz"}]},
               {
                RowBox[{"cx", "*", "cz"}], 
                RowBox[{"cy", "*", "cz"}], 
                SuperscriptBox["cz", "2"], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cz"}], 
                RowBox[{
                 RowBox[{"-", "cy"}], "*", "cz"}], 
                RowBox[{"-", 
                 SuperscriptBox["cz", "2"]}]},
               {
                RowBox[{"-", 
                 SuperscriptBox["cx", "2"]}], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cy"}], 
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cz"}], 
                SuperscriptBox["cx", "2"], 
                RowBox[{"cx", "*", "cy"}], 
                RowBox[{"cx", "*", "cz"}]},
               {
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cy"}], 
                RowBox[{"-", 
                 SuperscriptBox["cy", "2"]}], 
                RowBox[{
                 RowBox[{"-", "cy"}], "*", "cz"}], 
                RowBox[{"cx", "*", "cy"}], 
                SuperscriptBox["cy", "2"], 
                RowBox[{"cy", "*", "cz"}]},
               {
                RowBox[{
                 RowBox[{"-", "cx"}], "*", "cz"}], 
                RowBox[{
                 RowBox[{"-", "cy"}], "*", "cz"}], 
                RowBox[{"-", 
                 SuperscriptBox["cz", "2"]}], 
                RowBox[{"cx", "*", "cz"}], 
                RowBox[{"cy", "*", "cz"}], 
                SuperscriptBox["cz", "2"]}
              }], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Appending", " ", 
           StyleBox[
            RowBox[{"{", 
             RowBox[{"l", ",", " ", "cx", ",", " ", "cy", ",", " ", "cz"}], 
             "}"}],
            FontColor->RGBColor[0.5, 0, 0.5]], " ", "list", " ", "at", " ", 
           "the", " ", "end", " ", "of", " ", "each", " ", "bar", " ", "for", 
           " ", "further", " ", "use"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{
           RowBox[{"bar", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "cx", ",", "cy", ",", "cz"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "A", " ", "switch", " ", "to", " ", "find", " ", "the", " ", 
           "place", " ", "of", " ", "the", " ", "terms", " ", "in", " ", 
           "the", " ", "global", " ", "rigidity", " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["place",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"place", "[", "n1_", "]"}], ":=", 
          RowBox[{"Switch", "[", 
           RowBox[{"n1", ",", "\[IndentingNewLine]", "1", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"j1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], ",", 
            "\[IndentingNewLine]", "2", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"j1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", "3", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"3", "*", 
              RowBox[{"j1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "4", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"j2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], ",", 
            "\[IndentingNewLine]", "5", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"3", "*", 
               RowBox[{"j2", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], ",", 
            "\[IndentingNewLine]", "6", ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"3", "*", 
              RowBox[{"j2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Adding", " ", "the", " ", "rigidity", " ", "matrix", " ", "of", 
           " ", "the", " ", "bar", " ", "to", " ", "the", " ", "global", " ", 
           "rigidity", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"k", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"place", "[", "n1", "]"}], ",", 
                RowBox[{"place", "[", "n2", "]"}]}], "]"}], "]"}], "+=", 
             RowBox[{"kn", "[", 
              RowBox[{"[", 
               RowBox[{"n1", ",", "n2"}], "]"}], "]"}]}], ";"}], ",", 
           RowBox[{"{", 
            RowBox[{"n1", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n2", ",", "6"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "bar", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Constructing", " ", "unnecessary", " ", "row", " ", "and", " ", 
        "column", " ", "list", " ", 
        RowBox[{"(", 
         StyleBox["del",
          FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "due", " ", "to", 
        " ", "support", " ", "conditions"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"del", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"support", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "2"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"3", "*", 
                RowBox[{"support", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "2"}], 
              "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"support", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "3"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"3", "*", 
                RowBox[{"support", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], 
              "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"support", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", "4"}], "]"}], "]"}], "\[Equal]", "1"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del", ",", 
             RowBox[{"{", 
              RowBox[{"3", "*", 
               RowBox[{"support", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Length", "[", "support", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"del", "=", 
       RowBox[{"Sort", "[", "del", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
        "columns", " ", "from", " ", "the", " ", "global", " ", "rigidity", 
        " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{"k", ",", "del"}], "]"}], "]"}], ",", "del"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "There", " ", "is", " ", "a", " ", "big", " ", "IF", " ", "here"}], 
        ",", " ", 
        RowBox[{
        "if", " ", "the", " ", "system", " ", "is", " ", "kinematically", " ",
          "stable"}], ",", "\[IndentingNewLine]", 
        RowBox[{"then", " ", "continue"}], ",", " ", "else", ",", " ", 
        RowBox[{
        "return", " ", "\"\<0\>\"", " ", "as", " ", "the", " ", "result"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"PositiveDefiniteMatrixQ", "[", "k", "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Constructing", " ", "load", " ", "matrix", " ", 
          RowBox[{"(", 
           StyleBox["p",
            FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"3", "*", 
             RowBox[{"Length", "[", "jnt", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"3", "*", 
                 RowBox[{"force", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "2"}], "]"}],
               "]"}], "=", 
             RowBox[{"force", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"3", "*", 
                 RowBox[{"force", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], "]"}],
               "]"}], "=", 
             RowBox[{"force", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"[", 
               RowBox[{"3", "*", 
                RowBox[{"force", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
             RowBox[{"force", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", "4"}], "]"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "force", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
           "columns", " ", "from", " ", "the", " ", "force", " ", "matrix"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"N", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{"p", ",", "del"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Calculating", " ", "node", " ", "displacement", " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["d",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
           "adding", " ", "deleted", " ", "nodes"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"LinearSolve", "[", 
           RowBox[{"k", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"Insert", "[", 
             RowBox[{"d", ",", "0", ",", 
              RowBox[{"del", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "del", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "calculating", " ", "joint", " ", "displacement", " ", "capacity", 
           " ", "matrix", " ", 
           RowBox[{"(", 
            StyleBox["dC",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"dC", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"d", "/", "da"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "loop", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["f",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{"Bar", " ", "forces"}]}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["tensB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "tension", " ", "bars"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["compB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "compression", " ", "bars"}]}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"demand", "/", "capacity"}], " ", "ratios"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["sC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", "Stress"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["fbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Flexural", " ", "buckling"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["tbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Torsional", " ", "buckling"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["ftbC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Flexural", "-", 
             RowBox[{"torsional", " ", "buckling"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["lC",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", "Limiting"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["pfm",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Possible", " ", "failure", " ", "mode", " ", "of", " ", "the", 
             " ", "bars"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailS",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "stress", " ", "failure"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailFB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "flexural", " ", "buckling", " ", "failure"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailTB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
             "torsional", " ", "buckling", " ", "failure"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["bfailFTB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
             RowBox[{
             "Number", " ", "of", " ", "bars", " ", "prone", " ", "to", " ", 
              "flexural"}], "-", 
             RowBox[{"torsional", " ", "buckling", " ", "failure"}]}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["v",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Total", " ", "volume", " ", "of", " ", "material", " ", 
             "used"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["failB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Number", " ", "of", " ", "failed", " ", "bars"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excB",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Total", " ", "of", " ", "exceeding", " ", "capacity", " ", "of", 
             " ", "bars"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["dwg",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{"Truss", " ", "drawing"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"f", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "bar", " ", "forces", " ", 
           "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"tensB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "tension", " ", "bar", " ", "count"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"compB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "compression", " ", "bar", " ", 
           "count"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"sC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "stress", " ", "capacity", 
           " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"fbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "flexural", " ", 
           "buckling", " ", "capacity", " ", "matrix"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"tbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "torsional", " ", 
           "buckling", " ", "capacity", " ", "matrix"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ftbC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Template", " ", "for", " ", "the", " ", "flexural"}], "-", 
           RowBox[{
           "torsional", " ", "buckling", " ", "capacity", " ", "matrix"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lC", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "limiting", " ", 
           "capacity", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"pfm", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "bar", "]"}]}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Template", " ", "for", " ", "the", " ", "possible", " ", "failure",
            " ", "mode", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"bfailS", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "stress", " ", "failure"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"bfailFB", " ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "flexural", " ", "buckling", " ", "failure"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bfailTB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", " ",
            "to", " ", "torsional", " ", "buckling", " ", "failure"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"bfailFTB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Container", " ", "for", " ", "the", " ", "bars", " ", "prone", 
            " ", "to", " ", "flexural"}], "-", 
           RowBox[{"torsional", " ", "buckling", " ", "failure"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"v", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "total", " ", "volume", " ", "of", 
           " ", "the", " ", "bars"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"failB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"Container", " ", "for", " ", "failed", " ", "bars"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"excB", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "exceeding", " ", "capacity"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dwg", "=", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "the", " ", "truss", " ", "drawing", 
           " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Start", " ", 
            RowBox[{"(", 
             StyleBox["j1",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
            "end", " ", 
            RowBox[{"(", 
             StyleBox["j2",
              FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "joints", " ", 
            "of", " ", "the", " ", "bar"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"j1", "=", 
             RowBox[{"jnt", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "3"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"j2", "=", 
             RowBox[{"jnt", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "4"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Area", " ", 
               RowBox[{"(", 
                StyleBox["a",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
               "length", " ", 
               RowBox[{"(", 
                StyleBox["l",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "of", " ", 
               "the", " ", 
               RowBox[{"bar", ".", " ", 
                StyleBox["cx",
                 FontColor->RGBColor[0.5, 0, 0.5]]}]}], ",", " ", 
              StyleBox["cy",
               FontColor->RGBColor[0.5, 0, 0.5]], ",", " ", 
              RowBox[{
               StyleBox["cz",
                FontColor->RGBColor[0.5, 0, 0.5]], " ", "coefficients"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"a", "=", 
             RowBox[{"sec", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"bar", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"l", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cx", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cy", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"cz", "=", 
             RowBox[{"bar", "[", 
              RowBox[{"[", 
               RowBox[{"n", ",", 
                RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Assembling", " ", "internal", " ", "force", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "the", " ", "bar", " ", 
              "forces", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["f",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{
              FractionBox[
               RowBox[{"e", "*", "a"}], "l"], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"cx", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], 
                    "]"}], "-", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], 
                    "]"}]}], ")"}]}], "+", 
                RowBox[{"cy", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], 
                    "]"}], "-", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], 
                    "]"}]}], ")"}]}], "+", 
                RowBox[{"cz", "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", "*", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "-", 
                   RowBox[{"d", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", "*", 
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], 
                  ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Update", " ", "tension", " ", 
               RowBox[{"(", 
                StyleBox["tensB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "-", " ", 
              RowBox[{"compression", " ", 
               RowBox[{"(", 
                StyleBox["compB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "bar", " ", 
               "count"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ">", 
               "0"}], ",", 
              RowBox[{"tensB", "++"}], ",", 
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<", 
               "0"}], ",", 
              RowBox[{"compB", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Allowed", " ", "compressive", " ", "load", " ", "of", " ", 
              "the", " ", "bar", " ", 
              RowBox[{"(", 
               StyleBox["Pa",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Pa", "=", 
             RowBox[{"fa", "*", "a"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Assembling", " ", "stress", " ", "capacity", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["sC",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sC", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"Abs", "[", 
              FractionBox[
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "Pa"],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "If", " ", "the", " ", "member", " ", "is", " ", "under", " ", 
              "compression", " ", "calculate", " ", "the", " ", "global", " ",
               "buckling", " ", "capacities"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "<", 
               "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                "the", " ", "bar", " ", "about", " ", "x", " ", "axis", " ", 
                RowBox[{"(", 
                 StyleBox["Px",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Px", "=", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                   "]"}]}], 
                 SuperscriptBox["l", "2"]]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", "about", " ", "y", " ", "axis", " ", 
                 RowBox[{"(", 
                  StyleBox["Py",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Py", "=", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "4"}], "]"}], 
                   "]"}]}], 
                 SuperscriptBox["l", "2"]]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Flexural", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["Pf",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pf", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"Px", ",", "Py"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Assembling", " ", "flexural", " ", "buckling", " ", 
                 "capacity", " ", "of", " ", "the", " ", "bar", " ", "to", 
                 " ", "the", " ", "list", " ", 
                 RowBox[{"(", 
                  StyleBox["fbC",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"fbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pf"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 SubsuperscriptBox["r", "2", "2"], " ", "value", " ", "of", 
                 " ", "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["r2",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"r2", "=", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "3"}], "]"}], 
                    "]"}], "+", 
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "4"}], "]"}], 
                    "]"}]}], "a"], "+", 
                 SuperscriptBox[
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "2"], "+", 
                 SuperscriptBox[
                  RowBox[{"sec", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Torsional", " ", "buckling", " ", "load", " ", "of", " ", 
                 "the", " ", "bar", " ", 
                 RowBox[{"(", 
                  StyleBox["Pt",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pt", "=", 
                FractionBox[
                 RowBox[{
                  FractionBox[
                   RowBox[{"e", "*", 
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "5"}], "]"}], 
                    "]"}]}], 
                   RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Nu]"}], ")"}]}]], "+", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox["\[Pi]", "2"], "*", "e", "*", 
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "6"}], "]"}], 
                    "]"}]}], 
                   SuperscriptBox["l", "2"]]}], "r2"]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Assembling", " ", "torsional", " ", "buckling", " ", 
                 "capacity", " ", "of", " ", "the", " ", "bar", " ", "to", 
                 " ", "the", " ", "list", " ", 
                 RowBox[{"(", 
                  StyleBox["tbC",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pt"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Flexural", "-", 
                 RowBox[{
                 "torsional", " ", "buckling", " ", "load", " ", "of", " ", 
                  "the", " ", "bar", " ", 
                  RowBox[{"(", 
                   StyleBox["Pft",
                    FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "by", " ", 
                  "using", " ", 
                  StyleBox["Pcr",
                   FontColor->RGBColor[0.5, 0, 0.5]], " ", "variable"}]}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], "||", 
                  RowBox[{
                   RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "\[NotEqual]", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pft", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"Pcr", "/.", 
                    RowBox[{"NSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Px", "-", "Pcr"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Py"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Pt"}], ")"}], "*", "r2"}], "+", 
                    RowBox[{
                    SuperscriptBox["Pcr", "2"], "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Py"}], ")"}], "*", 
                    SuperscriptBox[
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "1"}], "]"}], "]"}], "2"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Pcr", "-", "Px"}], ")"}], "*", 
                    SuperscriptBox[
                    RowBox[{"sec", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "2"}], "]"}], "]"}], ",", "7", ",", 
                    "2"}], "]"}], "]"}], "2"]}]}], ")"}]}]}], "\[Equal]", 
                    "0"}], ",", "Pcr"}], "]"}]}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pft", "=", 
                   RowBox[{"Min", "[", 
                    RowBox[{"Pf", ",", "Pt"}], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Assembling", " ", "flexural"}], "-", 
                 RowBox[{
                 "torsional", " ", "buckling", " ", "capacity", " ", "of", 
                  " ", "the", " ", "bar", " ", "to", " ", "the", " ", "list", 
                  " ", 
                  RowBox[{"(", 
                   StyleBox["ftbC",
                    FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}],
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ftbC", "[", 
                 RowBox[{"[", 
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"f", "[", 
                   RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"\[Lambda]a", "*", "Pft"}]]}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                "Limiting", " ", "load", " ", "of", " ", "the", " ", "bar", 
                 " ", 
                 RowBox[{"(", 
                  StyleBox["Pl",
                   FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"Pl", "=", 
                RowBox[{"Min", "[", 
                 RowBox[{"Pa", ",", "Pf", ",", "Pt", ",", "Pft"}], "]"}]}], 
               ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "...", "Else", " ", "buckling", " ", "capacities", " ", "are",
                  " ", "Zero", " ", "which", " ", "are", " ", "preset", " ", 
                 "before", " ", "the", " ", "loop"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "limiting", " ", "load", " ", "is", " ", "equal", " ", "to", 
                 " ", "the", " ", "tensile", " ", "force", " ", "limit"}]}], 
               " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Pl", "=", "Pa"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "assembling", " ", "limiting", " ", "capacity", " ", "of", " ", 
              "the", " ", "bar", " ", "to", " ", "the", " ", "list", " ", 
              RowBox[{"(", 
               StyleBox["lC",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"lC", "[", 
              RowBox[{"[", 
               RowBox[{"bar", "[", 
                RowBox[{"[", 
                 RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
             RowBox[{"Abs", "[", 
              FractionBox[
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "Pl"],
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "assembling", " ", "possible", " ", "failure", " ", "mode", " ", 
              "of", " ", "the", " ", "bar", " ", "to", " ", "the", " ", 
              "list", " ", 
              RowBox[{"(", 
               StyleBox["pfm",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "counting", " ", "the", " ", "bars", " ", "which", " ", "are", 
               " ", "prone", " ", "to", " ", "stress", " ", 
               RowBox[{"(", 
                StyleBox["bfailS",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], ",", " ", 
              RowBox[{"flexural", " ", "buckling", " ", 
               RowBox[{"(", 
                StyleBox["bfailFB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"torsional", " ", "buckling", " ", 
                RowBox[{"(", 
                 StyleBox["bfailTB",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
                "flexural"}], "-", 
               RowBox[{"torsional", " ", "buckling", " ", 
                RowBox[{"(", 
                 StyleBox["bfailFTB",
                  FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", 
                "failure"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
               "\[Equal]", "0"}], ",", 
              RowBox[{
               RowBox[{"pfm", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
               "\"\<N\>\""}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Which", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Pl", "\[Equal]", "Pa"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<S\>\""}], ";", 
                  RowBox[{"bfailS", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Pl", "\[Equal]", "Pf"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<FB\>\""}], ";", 
                  RowBox[{"bfailFB", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Pl", "\[Equal]", "Pt"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<TB\>\""}], ";", 
                  RowBox[{"bfailTB", "++"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Pl", "\[Equal]", "Pft"}], "&&", 
                  RowBox[{"Pf", ">", "Pft"}], "&&", 
                  RowBox[{"Pt", ">", "Pft"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pfm", "[", 
                    RowBox[{"[", 
                    RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", 
                   "\"\<FTB\>\""}], ";", 
                  RowBox[{"bfailFTB", "++"}]}]}], "\[IndentingNewLine]", 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "adding", " ", "the", " ", "volume", " ", "of", " ", "the", " ", 
              "bar", " ", "to", " ", "the", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["v",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"v", "+=", 
             RowBox[{"a", "*", "l"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "If", " ", "limiting", " ", "capacity", " ", "exceeds", " ", 
               "1"}], ",", " ", 
              RowBox[{
              "update", " ", "failed", " ", "bars", " ", "counter", " ", 
               RowBox[{"(", 
                StyleBox["failB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
               "exceeding", " ", "container", " ", 
               RowBox[{"(", 
                StyleBox["excB",
                 FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"lC", "[", 
                RowBox[{"[", 
                 RowBox[{"bar", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ">", 
               "1"}], ",", 
              RowBox[{
               RowBox[{"failB", "++"}], ";", 
               RowBox[{"excB", "+=", 
                RowBox[{
                 RowBox[{"lC", "[", 
                  RowBox[{"[", 
                   RowBox[{"bar", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "-", 
                 "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "bar", " ", "lines", " ", "to", " ", "drawing", 
              " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Line", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Drop", "[", 
                  RowBox[{"j1", ",", "1"}], "]"}], ",", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"j2", ",", "1"}], "]"}]}], "}"}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "bar", " ", "labels", " ", "to", " ", "the", " ", 
              "drawing", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"bar", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "Blue", ",", 
                  RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "2"], ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "2"], ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"j1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "+", 
                    RowBox[{"j2", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "2"]}], "}"}]}], 
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "bar", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "loop", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["failJ",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{
             "Number", " ", "of", " ", "excessively", " ", "displaced", " ", 
              "joints"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excJ",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Exceeding", " ", "amount", " ", "of", " ", "joint", " ", 
             "displacement"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["dwg",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Adds", " ", "joint", " ", "labels", " ", "to", " ", "the", " ", 
             "truss", " ", "drawing"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"failJ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "excessively", " ", "deflected", " ", 
           "joints"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"excJ", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Exceeding", " ", "amount", " ", "of", " ", "joint", " ", 
           "deflection"}], " ", "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "If", " ", "limiting", " ", "displacement", " ", "is", " ", 
             "exceeded"}], ",", " ", 
            RowBox[{"update", " ", "failed", " ", "bars", " ", "counter", " ", 
             RowBox[{"(", 
              StyleBox["failJ",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}], " ", "and", " ", 
             "exceeding", " ", "container", " ", 
             RowBox[{"(", 
              StyleBox["excJ",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"dC", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ">", "1"}], ",", 
              RowBox[{
               RowBox[{"failJ", "++"}], ";", 
               RowBox[{"excJ", "+=", 
                RowBox[{
                 RowBox[{"dC", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "-", "1"}]}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adds", " ", "joint", " ", "labels", " ", "to", " ", "the", " ", 
              "truss", " ", "drawing", " ", 
              RowBox[{"(", 
               StyleBox["dwg",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"dwg", ",", 
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"jnt", "[", 
                   RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}], ",", "Red", ",", 
                  RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}], ",", 
                RowBox[{"Drop", "[", 
                 RowBox[{
                  RowBox[{"jnt", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "1"}], "]"}]}], 
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "jnt", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"This", " ", "section", " ", "determines"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             StyleBox["period",
              FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
             RowBox[{
             "Periods", " ", "of", " ", "requested", " ", "free", " ", 
              "vibration", " ", "modes"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            StyleBox["excM",
             FontColor->RGBColor[0.5, 0, 0.5]], " ", ":", 
            RowBox[{
            "Exceeding", " ", "amount", " ", "of", " ", "free", " ", 
             "vibration", " ", "period", " ", 
             RowBox[{"capacities", "."}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"period", "=", 
          RowBox[{"{", "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"empty", " ", "period", " ", "list"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"excM", "=", "0"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Container", " ", "for", " ", "exceeding", " ", "free", " ", 
           "vibration", " ", "capacities"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mode", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Constructing", " ", "mass", " ", "matrix", " ", 
             RowBox[{"(", 
              StyleBox["m",
               FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", "*", 
                  RowBox[{"Length", "[", "jnt", "]"}]}], ",", 
                 RowBox[{"3", "*", 
                  RowBox[{"Length", "[", "jnt", "]"}]}]}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "2"}], ",", 
                   RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "2"}]}], 
                  "]"}], "]"}], "=", 
                RowBox[{"mass", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "2"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}], ",", 
                   RowBox[{
                    RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], "-", "1"}]}], 
                  "]"}], "]"}], "=", 
                RowBox[{"mass", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "3"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"3", "*", 
                    RowBox[{"mass", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
                "=", 
                RowBox[{"mass", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", ",", "4"}], "]"}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "mass", "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Removing", " ", "unnecessary", " ", "rows", " ", "and", " ", 
              "columns", " ", "from", " ", "the", " ", "mass", " ", "matrix", 
              " ", 
              RowBox[{"(", 
               StyleBox["m",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"m", "=", 
             RowBox[{"N", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"m", ",", "del"}], "]"}], "]"}], ",", "del"}], 
                "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "periods", " ", "of", " ", "the", " ", 
              "requested", " ", "modes", " ", "to", " ", "the", " ", "list", 
              " ", 
              RowBox[{"(", 
               StyleBox["period",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"period", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "*", "\[Pi]"}], ")"}], "/", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                SqrtBox[
                 RowBox[{"Eigenvalues", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"k", ",", "m"}], "}"}], ",", 
                   RowBox[{"-", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]], ",", 
                RowBox[{"\[Infinity]", "|", 
                 RowBox[{"-", "\[Infinity]"}]}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Adding", " ", "exceeding", " ", "vibration", " ", "capacities", 
              " ", "to", " ", "the", " ", "container", " ", 
              RowBox[{"(", 
               StyleBox["excM",
                FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mode", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "<", 
                  RowBox[{"period", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], "<", 
                  RowBox[{"mode", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"excM", "+=", 
                   RowBox[{"Abs", "[", 
                    FractionBox[
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"period", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], "-", 
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"period", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], 
                    RowBox[{
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "-", 
                    RowBox[{"mode", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]], "]"}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"Length", "[", "period", "]"}]}], "}"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Arranging", " ", "the", " ", "results", " ", 
           RowBox[{"(", 
            StyleBox["res",
             FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"AbsoluteTime", "[", "]"}], "-", "sTime"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              FractionBox["tensB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["compB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"tensB", "+", "compB"}], 
                RowBox[{"Length", "[", "bar", "]"}]]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              FractionBox["failB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["failJ", 
               RowBox[{"Length", "[", "joint", "]"}]], ",", "excB", ",", 
              "excJ", ",", "excM", ",", 
              RowBox[{"excB", "+", "excJ", "+", "excM"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"d", ",", "f", ",", "period"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "dC", ",", "sC", ",", "fbC", ",", "tbC", ",", "ftbC", ",", 
              "lC"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"pfm", ",", 
              FractionBox["bfailS", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailFB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailTB", 
               RowBox[{"Length", "[", "bar", "]"}]], ",", 
              FractionBox["bfailFTB", 
               RowBox[{"Length", "[", "bar", "]"}]]}], "}"}], ",", 
            "\[IndentingNewLine]", "dwg"}], "\[IndentingNewLine]", "}"}]}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ELSE", " ", "section", " ", "of", " ", "the", " ", "big", " ", 
           RowBox[{"IF", ".", " ", "If"}], " ", "the", " ", "rigidity", " ", 
           "matrix", " ", "is", " ", "not", " ", "positive", " ", 
           "definite"}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "then", " ", "the", " ", "structure", " ", "is", " ", 
           "kinematically", " ", 
           RowBox[{"unstable", ".", " ", "The"}], " ", "software", " ", 
           "returns", " ", "0."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], "]"}]}], 
  ";"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.689349890960096*^9, 3.689350028069974*^9}, {
   3.689350063987007*^9, 3.689350082420111*^9}, {3.689350127219674*^9, 
   3.6893501566753473`*^9}, {3.689350189965223*^9, 3.6893502318736677`*^9}, {
   3.689350271306884*^9, 3.6893502994345446`*^9}, {3.6893504030554266`*^9, 
   3.689350457189575*^9}, {3.6893504876902876`*^9, 3.689350538615232*^9}, {
   3.68935056879596*^9, 3.6893505800836086`*^9}, 3.689350652088685*^9, {
   3.689351932404416*^9, 3.689351959729148*^9}, {3.689352319542137*^9, 
   3.6893523232958326`*^9}, {3.6895651041337*^9, 3.68956510516243*^9}, {
   3.689913820107711*^9, 3.6899138356186786`*^9}, {3.6899139053179593`*^9, 
   3.6899139394431043`*^9}, {3.6899145111173077`*^9, 
   3.6899145119018445`*^9}, {3.6899185794974375`*^9, 3.6899185938615932`*^9}, 
   3.689920826954042*^9, {3.6912218051616755`*^9, 3.691221808264876*^9}, {
   3.6944203859254313`*^9, 3.6944203967849455`*^9}, {3.6945015454759965`*^9, 
   3.6945015492499185`*^9}, {3.6996809167396135`*^9, 
   3.6996809175121417`*^9}, {3.702209093593913*^9, 3.702209095015791*^9}, {
   3.7110937121748247`*^9, 3.7110937796280518`*^9}, {3.7110964360266275`*^9, 
   3.7110964395668297`*^9}, 3.711096611836697*^9, {3.711096734551709*^9, 
   3.711096736993864*^9}, 3.711096913977003*^9, {3.711097620420457*^9, 
   3.7110976619497843`*^9}, {3.7110982227309265`*^9, 
   3.7110982239769707`*^9}, {3.71109843706322*^9, 3.711098478680607*^9}, 
   3.711098716424219*^9, 3.7110988197921214`*^9, {3.7111013602812347`*^9, 
   3.7111013767030926`*^9}, 3.711101561547205*^9, 3.711101838141543*^9}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Output", " ", "of", " ", "the", " ", "script", " ", "is", " ", "a", " ", 
    "nested", " ", "list", " ", "as", " ", "follows"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      StyleBox["Time",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"execution", " ", "time"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["v",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Material", " ", "volume"}]}], ",", " ", 
       RowBox[{
        StyleBox["tensB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Tension", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["compB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Compression", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["zeroB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Constructive", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["failB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Failed", " ", "bars", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["failJ",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Failed", " ", "joints", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["excB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excJ",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excM",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Mode", " ", "penalty"}]}], ",", " ", 
       RowBox[{
        StyleBox["excT",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"total", " ", "penalty"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["d",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", "displacements"}]}], ",", " ", 
       RowBox[{
        StyleBox["f",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", "forces"}]}], ",", " ", 
       RowBox[{
        StyleBox["period",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Requested", " ", "free", " ", "vibration", " ", "periods"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["dC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Joint", " ", 
         RowBox[{"disp", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["sC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Bar", " ", 
         RowBox[{"str", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["fbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Flex", " ", 
         RowBox[{"buck", ".", " ", "c", "."}]}]}], ",", " ", 
       RowBox[{
        StyleBox["tbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Tors", ".", " ", "buck", ".", " ", "c", "."}]}], ",", " ", 
       RowBox[{
        StyleBox["ftbC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Flex", ".", 
         RowBox[{"-", 
          RowBox[{"tors", ".", " ", "buck", ".", " ", "c", "."}]}]}]}], ",", 
       " ", 
       RowBox[{
        StyleBox["lC",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"Limiting", " ", 
         RowBox[{"c", "."}]}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        StyleBox["pfm",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Possible", " ", "failure", " ", "mode", " ", "of", " ", "the", " ", 
         "bars"}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailS",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{
        "Bar", " ", "count", " ", "prone", " ", "to", " ", "stress", " ", 
         "failure", 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailFB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"flex", ".", " ", "buck", ".", " ", "failure"}], 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailTB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"tors", ".", " ", "buck", ".", " ", "failure"}], 
         RowBox[{"(", "%", ")"}]}]}], ",", " ", 
       RowBox[{
        StyleBox["bfailFTB",
         FontColor->RGBColor[1, 0, 0]], " ", ":", 
        RowBox[{"..", 
         RowBox[{"flex", ".", " ", 
          RowBox[{"-", " ", 
           RowBox[{"tors", ".", " ", "buck", ".", " ", "failure"}]}]}], 
         RowBox[{"(", "%", ")"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      StyleBox["dwg",
       FontColor->RGBColor[1, 0, 0]], " ", ":", 
      RowBox[{"Truss", " ", "drawing"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.6899140207155514`*^9, 3.689914038387046*^9}, 
   3.689918618288865*^9, {3.711098856439193*^9, 3.7110988585273557`*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 3}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solveTruss3D", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"e", ",", "\[Nu]", ",", "fa", ",", "da", ",", "\[Lambda]a"}], 
    "}"}], ",", "joint", ",", "section", ",", "bars", ",", "support", ",", 
   "force", ",", "mass", ",", "mode"}], "]"}]], "Input",
 Editable->False,
 CellChangeTimes->{{3.689350667194549*^9, 3.689350677065151*^9}, {
  3.6893511313091726`*^9, 3.6893511352564015`*^9}, {3.6893514154767275`*^9, 
  3.6893514192649364`*^9}, {3.6893520101510153`*^9, 3.689352025921939*^9}, {
  3.689565124786281*^9, 3.6895651275992727`*^9}, {3.6899138498077126`*^9, 
  3.68991386222851*^9}, {3.7022091155678096`*^9, 3.7022091195950084`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0155481`5.643222318696036", ",", 
   RowBox[{"{", 
    RowBox[{"6.720644477870215`*^6", ",", 
     FractionBox["1", "3"], ",", 
     FractionBox["1", "2"], ",", 
     FractionBox["1", "6"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.010170204529808257`"}], ",", "0.0020561051380977146`", 
       ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "0.4714195961761861`"}], ",", "1.5732429588503876`", ",", 
       RowBox[{"-", "0.0388926092748837`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "931.6949906249121`"}], ",", 
       RowBox[{"-", "931.6949906249118`"}], ",", "0", ",", 
       "17688.714622606127`", ",", "6871.842709362765`", ",", 
       RowBox[{"-", "60927.79481119889`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.02443199743386766`", ",", "0.05638065039096867`", ",", 
       "0.08237213969288372`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0.0005085102264904129`", ",", 
       "0.00010280525690488574`", ",", "0", ",", "0", ",", "0", ",", "0", ",",
        "0.023570979808809307`", ",", "0.07866214794251938`", ",", 
       "0.0019446304637441851`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.003433672097937803`", ",", "0.00420591815919516`", ",", "0", ",", 
       "0.07985154668926564`", ",", "0.02532551404696297`", ",", 
       "0.21891274364472152`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.010008292533794037`", ",", "0.004965540345960116`", ",", "0", ",", 
       "0", ",", "0", ",", "0.29770879953505613`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.0016299036643387108`", ",", "0.004687951712198922`", ",", "0", ",", 
       "0", ",", "0", ",", "0.7024103899265337`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.010008292533794037`", ",", "0.007440088934035598`", ",", "0", ",", 
       "0", ",", "0", ",", "0.7024103899265337`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.010008292533794037`", ",", "0.007440088934035598`", ",", "0", ",", 
       "0.07985154668926564`", ",", "0.02532551404696297`", ",", 
       "0.7024103899265337`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"FB\"\>", ",", "\<\"FTB\"\>", ",", "\<\"N\"\>", 
       ",", "\<\"S\"\>", ",", "\<\"S\"\>", ",", "\<\"TB\"\>"}], "}"}], ",", 
     FractionBox["1", "3"], ",", 
     FractionBox["1", "6"], ",", 
     FractionBox["1", "6"], ",", 
     FractionBox["1", "6"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1200", ",", "600", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["1",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"600", ",", "300", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1200", ",", "600", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1200", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["2",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"600", ",", "900", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1200", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["3",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "600", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800", ",", "600", ",", "1600"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["4",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"400", ",", "300", ",", "800"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1200", ",", "600", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800", ",", "600", ",", "1600"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["5",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "600", ",", "800"}], "}"}]}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1200", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"800", ",", "600", ",", "1600"}], "}"}]}], "}"}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["6",
        StripOnInput->False,
        LineColor->RGBColor[0, 0, 1],
        FrontFaceColor->RGBColor[0, 0, 1],
        BackFaceColor->RGBColor[0, 0, 1],
        GraphicsColor->RGBColor[0, 0, 1],
        FontSize->10,
        FontColor->RGBColor[0, 0, 1]], ",", 
       RowBox[{"{", 
        RowBox[{"400", ",", "900", ",", "800"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["1",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["2",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"1200", ",", "600", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["3",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1200", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"Text", "[", 
      RowBox[{
       StyleBox["4",
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontSize->10,
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"{", 
        RowBox[{"800", ",", "600", ",", "1600"}], "}"}]}], "]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.711102491766117*^9, 3.7111024984067497`*^9}, {
  3.7111035101300573`*^9, 3.7111035213644285`*^9}}]
}, Open  ]]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 690, 13, 50, "Input"],
Cell[1251, 35, 273, 9, 5, "Text"],
Cell[1527, 46, 11319, 279, 582, "Input"],
Cell[12849, 327, 273, 9, 5, "Text"],
Cell[13125, 338, 5486, 137, 302, "Input"],
Cell[18614, 477, 271, 9, 10, "Text"],
Cell[18888, 488, 101325, 2480, 6691, "Input"],
Cell[120216, 2970, 271, 9, 10, "Text"],
Cell[120490, 2981, 5661, 154, 278, "Input"],
Cell[126154, 3137, 273, 9, 5, "Text"],
Cell[CellGroupData[{
Cell[126452, 3150, 669, 12, 30, "Input"],
Cell[127124, 3164, 8570, 234, 199, "Output"]
}, Open  ]]
}
]
*)

